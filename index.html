<!doctype html>
<html lang="">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <link rel="icon" href="/logo.png">
  <link rel="apple-touch-icon" href="/logo.png">
  <link rel="mask-icon" href="/logo.png" color="#f4b400">

  <meta name="description" content="Sanyue ImgHub - A modern file hosting platform">
  <meta name="keywords" content="Sanyue, ImgHub, file hosting, image hosting, cloud storage">
  <meta name="author" content="SanyueQi">

  <title>Sanyue ImgHub</title>

  <link href="/css/chunk-vendors.78806b00.css" rel="stylesheet">
  <link href="/css/app.56292e98.css" rel="stylesheet">
</head>

<body>
<noscript>
  <strong>We're sorry but sanyue_imghub doesn't work properly without JavaScript enabled.</strong>
</noscript>

<!-- SPA 挂载点 -->
<div id="app"></div>

<script>
(async function () {
  try {
    const res = await fetch("/api/user?action=me", {
      credentials: "include"
    });

    if (!res.ok) throw new Error("Not logged in");

    const user = await res.json();

    // 全局暴露用户信息，供 SPA 使用
    window.__IMGBED_USER__ = user;

    // 登录成功，加载真正的 SPA
    loadApp();

  } catch (e) {
    // 未登录：加载“登录版 SPA”或跳转
    window.location.href = "/login.html";
  }
})();

function loadApp() {
  const script = document.createElement("script");
  script.src = "/js/app.87ae8c4b.js";
  script.defer = true;
  document.body.appendChild(script);
}
</script>

</body>
</html>
